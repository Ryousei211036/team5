//==============================================================================================
//
// ゲーム　　　game.cpp
// 土田凌聖
//
//==============================================================================================
#include"game.h"
#include"inputkeyboard.h"
#include"application.h"
#include"fade.h"
#include"camera.h"

CCamera *CGame::m_pCamera = nullptr;

//==============================================================================================
// コンストラクタ
//==============================================================================================
CGame::CGame(int nPriority) : CObject(nPriority)
{
}

//==============================================================================================
// デストラクタ
//==============================================================================================
CGame::~CGame()
{
}

//==============================================================================================
// 初期化処理
//==============================================================================================
HRESULT CGame::Init()
{
	// 生成
	m_pCamera = new CCamera;	// カメラ

	// カメラの初期化
	m_pCamera->Init();

	CObject2D *pObject2D = CObject2D::Create({ 1280 / 2, 720 / 2, 0.0f }, { 910.0f, 510.0f, 0.0f });
	pObject2D->SetTexture(CTexture::TEXTURE_GAME);

	return S_OK;
}

//==============================================================================================
// 終了処理
//==============================================================================================
void CGame::Uninit()
{
	// カメラの終了
	if (m_pCamera != nullptr)
	{
		m_pCamera->Uninit();
		delete m_pCamera;
		m_pCamera = nullptr;
	}

	Release();
}

//==============================================================================================
//更新処理
//==============================================================================================
void CGame::Update()
{
	// カメラの更新
	m_pCamera->Update();

	CInputkeyboard *pKeyboard = CApplication::GetInputKeyboard();

	if (pKeyboard->GetKeyboardTrigger(DIK_RETURN))
	{
		CFade::SetFade(CApplication::MODE_RESULT, 0.05f);
	}
}

//==============================================================================================
// 描画処理
//==============================================================================================
void CGame::Draw()
{
	m_pCamera->SetCamera();
}

//==============================================================================================
// 生成処理
//==============================================================================================
CGame *CGame::Create()
{
	CGame *pGame = nullptr;

	pGame = new CGame;

	if (pGame != nullptr)
	{
		pGame->Init();
	}

	return pGame;
}